image: maven:latest

variables:
  MYSQL_ROOT_PASSWORD: secret
  ACCOUNT_PWD: pwd

build:
  stage: build
  before_script:
    - mvn clean
  script:
    - export DOCKER_PASSWORD=thisisnothidden1
    - git checkout master
    - login --host-password=thisisnothidden2 --username=anna
    - export DB_PASSWD_1=thisisnothidden3
    - netlify deploy --auth="$NETLIFY_AUTH_TOKEN"
    - test token=$COVERITY_TOKEN
    - mysql -u root --password=$MYSQL_ROOT_PASSWORD
    - login --pwd="$ACCOUNT_PWD"
    - publish --key-file=key
    - deploy --password=pw.json
    - stage --password=ksowb.idjoea.333.sdflsd
    - make test release IMAGE=registry.gitlab.com/leanlabsio/kanban TAG=${CI_BUILD_REF:0:12} REGISTRY_USERNAME=gitlab-ci-token REGISTRY_PASSWORD=$CI_BUILD_TOKEN